결론부터 말하면 **“1분마다 받을 필요는 없고, 오히려 비추천”**이에요.
지금 목표가 **30분/1시간/3시간 봉 기준 추천**이라면 웹훅도 그 기준에 맞춰 받는 게 가장 깔끔합니다.

## 왜 1분 웹훅이 비효율적인가

* **서버 부담/DB 부하 증가**: 1분은 하루 1,440개 × 심볼 × 지표 계산/업데이트가 쌓여요. (1GB RAM이면 특히 부담)
* **신호가 “봉 마감” 기준인데, 1분 데이터는 대부분 노이즈**: 추천 로직이 30m/1h/3h면 1분을 받아도 결국 그걸 다시 집계해야 합니다.
* **불일치/레이스 컨디션 증가**: 디스코드 알림 vs 사이트 추천이 어긋나는 문제가 1분 수신에서 더 잘 생겨요(부분 업데이트 상태에서 계산되기 때문).

## 권장 설계 (가장 현실적)

### A안(권장): “타임프레임별 봉 마감 웹훅”

* 트레이딩뷰에서 **30m/1h/3h 차트 각각** 알림을 만들고
  **“바 마감 시”** 웹훅을 보냅니다.
* 서버는 받은 봉만 upsert → 해당 tf만 계산 → 캐시 갱신
* 장점: 구현 단순, 자원 절약, 불일치 최소화

### B안(대안): “1분을 받되, 서버에서 집계”

* 1분 봉을 계속 저장하고, 서버가 30m/1h/3h로 **리샘플링**해서 사용
* 장점: 트뷰 알림 1개로 모든 tf 생성 가능
* 단점: 구현/운영 난이도↑, 서버자원↑, 누락/지연 처리 복잡↑
  (1GB RAM 환경이면 굳이 추천 안 함)

## 그래서 “몇 분마다”가 적당해?

* **추천 기능만**이면:
  ✅ **30분마다 + 1시간마다 + 3시간마다**(각 봉 마감 시)
* **변동성/거래량 급증 알림도 실시간에 가깝게** 하고 싶으면:
  ✅ 추가로 **1분 또는 5분 웹훅을 ‘알림 전용’**으로만 받는 방식이 좋아요.
  (추천 엔진 계산에는 안 쓰고, “급변 감지”만)

## 실무 팁: 불일치 방지 규칙

* 추천 계산은 항상 **“가장 최근에 ‘완전히 마감된’ 30m/1h/3h 봉 timestamp”**로만 실행
* 1분 알림을 쓰더라도 추천 캐시는 **tf 마감 이벤트에서만 갱신**
  (이렇게 하면 디스코드/사이트 불일치가 크게 줄어요)

원하면 내가 바로 다음을 정리해줄게요:

* **트레이딩뷰 알림을 30m/1h/3h 각각 만드는 방식**(바 마감 옵션 포함)
* 웹훅 JSON에 `timeframe`/`bar_close_confirmed` 같은 필드 넣는 표준 스키마
* “알림 전용 1분”을 섞을 때의 기준(예: ATR%, volume z-score)
